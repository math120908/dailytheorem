<!DOCTYPE html><html lang="[&quot;zh-TW&quot;,&quot;en&quot;,&quot;default&quot;]"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Transitive Closure 問題與矩陣相乘的關聯 | Daily Theorem</title><link rel="stylesheet" type="text/css" href="/dailytheorem/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/dailytheorem/favicon.ico"><link rel="apple-touch-icon" href="/dailytheorem/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/dailytheorem/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Transitive Closure 問題與矩陣相乘的關聯</h1><a id="logo" href="/dailytheorem/.">Daily Theorem</a><p class="description">每日演算法相關證明</p></div><div id="nav-menu"><a class="current" href="/dailytheorem/."><i class="fa fa-home"> 首頁</i></a><a href="/dailytheorem/archives/"><i class="fa fa-archive"> 所有文章</i></a><a href="/dailytheorem/about/"><i class="fa fa-user"> 關於</i></a><a href="/dailytheorem/atom.xml"><i class="fa fa-rss"> 訂閱</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Transitive Closure 問題與矩陣相乘的關聯</h1><div class="post-meta">Jan 7, 2018</div><div class="post-content"><h2 id="Transitive-Closure-問題"><a href="#Transitive-Closure-問題" class="headerlink" title="Transitive Closure 問題"></a>Transitive Closure 問題</h2><p>給定一個 $n$ 個點的有向無權圖 $G=(V, E)$，我們想要計算出一個 $n\times n$ 的二元矩陣 $TC$，其中如果 $v_i$ 有一條路徑可以到 $v_j$，那麼 $TC[i, j] = 1$，否則 $TC[i, j] = 0$。</p>
<h2 id="演算法們"><a href="#演算法們" class="headerlink" title="演算法們"></a>演算法們</h2><p>簡單的演算法包括：從每一個點分別作一次 DFS/BFS，找出可以到達的點集，這樣花的時間是 $O(nm)$。</p>
<p>另一種演算法是基於二元矩陣相乘的：我們令 $A$ 表示圖 $G$ 的鄰接矩陣（Adjacency Matrix），那麼我們可以知道 $TC = A \lor A^2 \lor A^3 \lor \cdots \lor A^{n-1}$。在二元矩陣相乘的世界中，無論作什麼操作都是 MOD 2。（也就是說，乘法是 AND、加法是 XOR）。如果我們允許加法變成 OR 的話，那麼我們更可以寫成 $TC = A^{n-1}$，因為此時 $A^{n-1}[i, j]$ 代表的是從 $i$ 到 $j$ 走至多 $n-1$ 步是否能到達。</p>
<p>從上述的方法中，我們知道 Transitive Closure 問題可以轉化為 Boolean Matrix Multiplication。如果寫成公式的話長這樣：</p>
<p>$${\tt{TC}}\leq_p {\tt{BMM}}$$</p>
<p>今天要聊的有兩件事情：</p>
<ol>
<li>其實二元矩陣相乘（加法是 OR 版）可以轉化為 Transitive Closure。</li>
<li>利用矩陣相乘的演算法可以在 $O(n^\omega)$ 時間內算出，因此上述轉化的過程我們得到一個計算 Transitive Closure 的 $O(n^\omega \lg n)$ 的方法。但實際上，我們可以做到 $O(n^\omega)$ 時間。</li>
</ol>
<h2 id="二元矩陣相乘的等價性"><a href="#二元矩陣相乘的等價性" class="headerlink" title="二元矩陣相乘的等價性"></a>二元矩陣相乘的等價性</h2><p>這個證明是來自 Fischer 和 Meyer 1971 年的結果。</p>
<p>要證明 ${\tt{BMM}}\leq_p {\tt{TC}}$，我們假設有一個厲害的演算法可以解決 Transitive Closure 問題。<br>對於兩個給定的方陣 $A, B\in\{0, 1\}^{n\times n}$，我們構造出以下的圖，使得它的鄰接矩陣長得像這樣：</p>
<p>$$\left(<br>    \begin{array}{c|c|c}<br>    I &amp; A &amp; 0\\<br>    \hline<br>    0 &amp; I &amp; B\\<br>    \hline<br>    0 &amp; 0 &amp; I<br>\end{array}<br>\right)$$</p>
<p>經過一陣精密計算後，我們發現他的 Transitive Closure 長得像這樣：</p>
<p>$$\left(<br>    \begin{array}{c|c|c}<br>    I &amp; A &amp; {\color{red}{AB}}\\<br>    \hline<br>    0 &amp; I &amp; B\\<br>    \hline<br>    0 &amp; 0 &amp; I<br>\end{array}<br>\right)$$</p>
<p>所以我們就可以輕易地透過「解決 Transitive Closure 問題」來解決「Binary Matrix Multiplication」了，他們是差不多難度的問題！</p>
<h2 id="用矩陣相乘時間來算-Transitive-Closure"><a href="#用矩陣相乘時間來算-Transitive-Closure" class="headerlink" title="用矩陣相乘時間來算 Transitive Closure"></a>用矩陣相乘時間來算 Transitive Closure</h2><p>本節的目標是介紹一個演算法，利用與矩陣相乘同樣的漸進函數時間算出 Transitive Closure。<br>事實上，他只利用了一個單純的分而治之技巧！</p>
<p>這個演算法是 Munro 在 1971 年的時候提出來的：</p>
<ol>
<li>首先先把整個圖用強連通塊演算法(strongly connected components)縮起來（因為屬於同一個強連通塊的點，可以連通到／被連通到的點集合都相同）。</li>
<li>因此我們可以假設輸入的圖會是一個 DAG (directed acyclic graph)。</li>
<li>既然整個圖是一個 DAG，它就會存在一個拓樸排序 (topological order)，這個順序可以用一次 DFS 在線性時間得到。</li>
<li>假設輸入的點集合是一個拓樸排序，我們發現他的鄰接矩陣可以排列成一個上三角矩陣：<br>$$M = \left(<br>\begin{array}{c|c}<br>A &amp; X \\<br>\hline<br>0 &amp; B<br>\end{array}<br>\right)$$<br>其中 $A, B$ 也都是上三角矩陣。</li>
<li>透過觀察可以發現，Transitive Closure 可以表示為<br>$$M^{\star} = \left(<br>\begin{array}{c|c}<br>A^{\star} &amp; A^{\star} XB^{\star}\\<br>\hline<br>0 &amp; B^{\star}<br>\end{array}<br>\right)$$<br>如果實際計算 $A^{\star}XB^{\star}$ 用一般的 $O(n^\omega)$ 矩陣相乘，那麼我們可以得到以下遞迴式：<br>$$ T(n) = 2T(n/2) + O(n^\omega)$$<br>解得<br>$$T(n) = O(n^\omega)。$$</li>
</ol>
<h2 id="後話-——-真的只能用一般矩陣相乘來算-Transitive-Closure-了嗎？"><a href="#後話-——-真的只能用一般矩陣相乘來算-Transitive-Closure-了嗎？" class="headerlink" title="後話 —— 真的只能用一般矩陣相乘來算 Transitive Closure 了嗎？"></a>後話 —— 真的只能用一般矩陣相乘來算 Transitive Closure 了嗎？</h2><p>從文章前面的部分，我們可以知道計算 Transitive Closure 與二元矩陣相乘其實是等價的。但問題是，二元矩陣相乘是不是只能用跟一般矩陣相乘相同的方法做呢？</p>
<p>如果說一般的矩陣相乘是 $(\times, +)$-矩陣相乘的話，我們需要的二元矩陣相乘其實是 $(\land, \lor)$-矩陣相乘。這兩者還是稍有不同的。比方說，後者不支援「減法」的存在，所以像是 <a href="https://en.wikipedia.org/wiki/Strassen_algorithm" target="_blank" rel="noopener">Strassen 演算法</a> 等矩陣相乘演算法就沒有辦法直接套用在二元矩陣的情形上。因此在二元矩陣相乘的研究上，衍伸出了另一派被稱為「Combinatorial Algorithm」的演算法類型。雖然沒有明確的定義，但這個流派的演算法似乎與二元矩陣有較深的關聯。<br>不過就效率而言，目前這一系列不仰賴實數體／整數環的演算法相對較差，都是 $\tilde{O}(n^3/\log^cn)$ 等級的。</p>
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><p>[1] <a href="https://www.cs.bgu.ac.il/~dinitz/Course/SS-12/transitiveClosure.pdf" target="_blank" rel="noopener">https://www.cs.bgu.ac.il/~dinitz/Course/SS-12/transitiveClosure.pdf</a><br>[2] <a href="http://theory.stanford.edu/~yuhch123/files/cbmm.pdf" target="_blank" rel="noopener">http://theory.stanford.edu/~yuhch123/files/cbmm.pdf</a><br>[3] Efficient Determination of the Transitive Closure of a Directed Graph, Munro 1971 <a href="https://www.sciencedirect.com/science/article/pii/S0019995873902283" target="_blank" rel="noopener">https://www.sciencedirect.com/science/article/pii/S0019995873902283</a><br>[4] Boolean matrix multiplication and transitive closure, Fischer and Meyer 1971 <a href="http://ieeexplore.ieee.org/document/4569672/" target="_blank" rel="noopener">http://ieeexplore.ieee.org/document/4569672/</a><br>[5] A Fast Expected Time Algorithm for Boolean Matrix Multiplication and Transitive Closure, O’Neil 1973 <a href="https://ac.els-cdn.com/S0019995873902283/1-s2.0-S0019995873902283-main.pdf?_tid=082c89aa-f96e-11e7-b46d-00000aab0f6b&amp;acdnat=1515963843_169630399eb8c8e785f8b7c7490c6cef" target="_blank" rel="noopener">https://ac.els-cdn.com/S0019995873902283/1-s2.0-S0019995873902283-main.pdf?_tid=082c89aa-f96e-11e7-b46d-00000aab0f6b&amp;acdnat=1515963843_169630399eb8c8e785f8b7c7490c6cef</a> </p>
</div><div class="tags"><a href="/dailytheorem/tags/Graph-Algorithms/">Graph Algorithms</a><a href="/dailytheorem/tags/Matrix-Multiplication/">Matrix Multiplication</a></div><div class="post-nav"><a class="next" href="/dailytheorem/2017/12/19/makespan/">Makespan 問題的 Greedy 近似解法</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://tmt514.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分類</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 標籤</i></div><div class="tagcloud"><a href="/dailytheorem/tags/Graph-Algorithms/" style="font-size: 15px;">Graph Algorithms</a> <a href="/dailytheorem/tags/Matrix-Multiplication/" style="font-size: 15px;">Matrix Multiplication</a> <a href="/dailytheorem/tags/Greedy-Algorithms/" style="font-size: 15px;">Greedy Algorithms</a> <a href="/dailytheorem/tags/Approximation-Algorithms/" style="font-size: 15px;">Approximation Algorithms</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/dailytheorem/2018/01/07/Transitive-Closure/">Transitive Closure 問題與矩陣相乘的關聯</a></li><li class="post-list-item"><a class="post-list-link" href="/dailytheorem/2017/12/19/makespan/">Makespan 問題的 Greedy 近似解法</a></li><li class="post-list-item"><a class="post-list-link" href="/dailytheorem/2017/12/14/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友站連結</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/dailytheorem/." rel="nofollow">tmt514.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/dailytheorem/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/dailytheorem/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/dailytheorem/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/dailytheorem/js/smartresize.js?v=0.0.0"></script></div></body></html>